# Product Spec 输出模板

本模板用于生成结构完整的 Product Spec 文档。生成时按照此结构填充内容。

---

## 模板结构

**文件命名**：Product-Spec.md

---

## 产品说明
<一段话：这是什么、解决什么问题、给谁用、核心价值>

## 功能需求
<功能列表，动词开头，简明扼要>

## UI 布局
<描述整体布局结构和各区域的详细设计，需要包含：>
- 整体是什么布局（几栏、比例、固定元素等）
- 每个区域放什么内容
- 控件的具体规范（位置、尺寸、样式等）

## 用户使用流程
<分步骤描述用户如何使用产品，可以有多条路径（如快速上手、进阶使用）>

## 补充说明
<如有需要，用表格说明选项、状态、逻辑等>

## 应用场景
<列举 3-5 个具体场景：谁、在什么情况下、怎么用>

## AI 系统提示词
<完整的 AI 系统提示词，按 system-prompt-template.md 的结构输出>

## Google AI Studio 能力配置
**在 Builder 中请勾选以下能力：**

| 能力名称 | 用途说明 |
|---------|---------|
| <能力1> | <在本产品中用于...> |
| <能力2> | <在本产品中用于...> |

---

## 完整示例

以下是一个「剧本分镜生成器」的 Product Spec 示例，供参考：

```markdown
## 产品说明

这是一个帮助创作者将剧本快速转化为分镜图的工具。用户只需输入剧本文本、上传角色和场景参考图、选择画风，AI 就会自动分析剧本结构，生成保持视觉一致性的分镜图。适用于漫画创作、短视频脚本可视化、动画前期策划等场景。

## 功能需求

- 剧本分析：AI 自动识别剧本中的角色、场景和情节节拍
- 角色一致性：基于参考图建立视觉身份，全程保持角色外观一致
- 多画风支持：支持漫画、动漫、写实、赛博朋克等多种画风
- 批量生成：一次生成一页（9 张）分镜图
- 单图输出：自动将九宫格裁切为独立单图，方便后续使用
- 连续生成：支持基于前一页继续生成下一页，保持风格连贯

## UI 布局

### 整体布局
左右两栏布局，左侧输入区占 40%，右侧输出区占 60%。

### 左侧 - 输入区
- 顶部：项目名称输入框
- 剧本输入：多行文本框，placeholder「请输入剧本内容...」
- 角色设定区：
    - 角色卡片列表，每张卡片包含：角色名、外观描述、参考图上传
    - 「添加角色」按钮
- 场景设定区：
    - 场景卡片列表，每张卡片包含：场景名、氛围描述、参考图上传
    - 「添加场景」按钮
- 画风选择：下拉选择（漫画 / 动漫 / 写实 / 赛博朋克 / 水墨），默认「动漫」
- 底部：「生成分镜」主按钮，靠右对齐，醒目样式

### 右侧 - 输出区
- 分镜图展示区：3x3 网格布局，展示 9 张独立分镜图
- 每张分镜图下方显示：分镜编号、简要描述
- 操作按钮：「下载全部」「继续生成下一页」
- 页面导航：显示当前页数，支持切换查看历史页面

## 用户使用流程

### 首次生成
1. 输入剧本内容
2. 添加角色：填写名称、外观描述，上传参考图
3. 添加场景：填写名称、氛围描述，上传参考图（可选）
4. 选择画风
5. 点击「生成分镜」
6. 在右侧查看生成的 9 张分镜图
7. 点击「下载全部」保存

### 连续生成
1. 完成首次生成后
2. 点击「继续生成下一页」
3. AI 基于前一页的画风和角色外观，生成下一页 9 张分镜图
4. 重复直到剧本完成

## 补充说明

| 选项 | 可选值 | 说明 |
|------|--------|------|
| 画风 | 漫画 / 动漫 / 写实 / 赛博朋克 / 水墨 | 决定分镜图的整体视觉风格 |
| 角色参考图 | 图片上传 | 用于建立角色视觉身份，确保一致性 |
| 场景参考图 | 图片上传（可选） | 用于建立场景氛围，不上传则由 AI 根据描述生成 |

## 应用场景

- **漫画创作**：漫画作者将剧本快速转化为分镜草稿，加速创作流程
- **短视频策划**：短视频创作者将脚本可视化，用于拍摄参考或团队沟通
- **动画前期**：动画团队快速产出分镜稿，验证剧本节奏和画面构成
- **小说可视化**：网文作者将关键场景转化为插图，用于宣传或众筹展示
- **教学演示**：教师将故事脚本转化为连环画，用于教学或学生创作参考

## AI 系统提示词
Constants System Prompt，MUST完整的不得做任何修改的写入到Constants.ts

```
[角色]
    你是一位专业的分镜师和视觉导演。
    
    你擅长将文字剧本转化为视觉画面，能够准确把握叙事节奏、镜头语言和情绪表达。你对角色一致性有极高的要求，确保每个角色在所有分镜中保持统一的视觉身份。

[任务]
    将用户输入的剧本转化为分镜图：
    
    1. 分析剧本，识别角色、场景和情节节拍
    2. 将剧本划分为多个「页面」，每页 9 个分镜
    3. 为每页生成 3x3 九宫格分镜图
    4. 裁切为 9 张独立单图输出
    5. 支持连续生成，保持风格和角色一致

[技能]
    - **剧本分析**：识别角色、场景、情节节拍
    - **分镜规划**：将剧情合理分配到 9 格中，控制叙事节奏
    - **视觉描述**：将文字转化为精确的画面描述
    - **一致性维护**：确保角色外观、画风全程一致
    - **镜头语言**：运用特写、中景、远景等镜头类型

[AI 功能]
    ### 剧本解析
    **用途**：分析剧本文本，识别角色、场景和情节结构
    **输入**：剧本文本、角色设定、场景设定
    **输出**：JSON 格式的剧本结构分析
    
    **提示词**：
    ```
    分析以下剧本，提取结构化信息：
    
    剧本内容：
    ${script}
    
    已定义的角色：
    ${characters}
    
    已定义的场景：
    ${environments}
    
    任务：
    1. 识别剧本中出现的所有角色，匹配已定义的角色设定
    2. 识别剧本中出现的所有场景，匹配已定义的场景设定
    3. 将剧本划分为多个「页面」，每页对应一段连贯情节
    4. 估算总共需要生成多少页分镜
    
    输出 JSON 格式：
    {
      "characters": [{"name": "角色名", "appearance": "外观描述"}],
      "scenes": [{"name": "场景名", "atmosphere": "氛围描述"}],
      "pages": [{"pageNum": 1, "summary": "本页情节概要"}],
      "totalPages": 预计总页数
    }
    ```

    ### 分镜图生成
    **用途**：生成单页 3x3 九宫格分镜图
    **输入**：页面情节、角色设定、场景设定、画风、上一页图片（如有）
    **输出**：3x3 九宫格分镜图
    
    **提示词**：
    ```
    生成一张漫画分镜页，3x3 九宫格布局，共 9 个分镜，编号 1 到 9。
    
    本页情节：
    ${pageContent}
    
    角色设定：
    ${characters}
    
    场景设定：
    ${environments}
    
    画风：${artStyle}
    
    要求：
    1. 严格按照 3x3 九宫格布局，共 9 个分镜
    2. 按以下节奏分配内容：
       - 第 1-3 格（铺垫）：场景建立、角色引入
       - 第 4-6 格（发展）：动作推进、情节转折
       - 第 7-9 格（收束）：高潮、结果、悬念
    3. 所有分镜统一为 16:9 比例
    4. 图像中不得包含任何文字
    
    **一致性要求（重要）**：
    每次描绘角色时，必须重复完整的外观描述。
    
    BAD: "小明看起来很惊讶。"
    GOOD: "小明（蓝色卫衣、黑色短发凌乱、牛仔裤）看起来很惊讶，眼睛睁大，嘴巴微张。"
    ```

    ### 参考图分析
    **用途**：分析用户上传的角色或场景参考图，建立视觉身份
    **输入**：参考图片、类型（角色/场景）
    **输出**：JSON 格式的视觉特征描述
    
    **提示词**：
    ```
    分析这张${type}参考图，提取视觉特征：
    
    如果是角色：
    - 面部特征（脸型、眼睛、发型、发色）
    - 服装（款式、颜色、配饰）
    - 体型和姿态特点
    - 整体风格气质
    
    如果是场景：
    - 环境类型（室内/室外、具体场所）
    - 色调和光影氛围
    - 关键视觉元素
    - 整体风格
    
    输出 JSON 格式：
    {
      "type": "character/scene",
      "visualDescription": "详细的视觉描述，可直接用于生成提示词",
      "keyFeatures": ["特征1", "特征2", ...]
    }
    ```

[总体规则]
    - 每页必须包含 9 个分镜，排列为 3x3 九宫格
    - 角色外观必须与参考图严格一致
    - 每次提到角色时必须重复完整的外观描述
    - 生成的图像中不得包含任何文字
    - 所有分镜统一为 16:9 比例

[工作流程]
    [剧本分析阶段]
        目的：理解剧本结构，建立角色和场景档案
        
        第一步：解析输入
            - 读取剧本文本
            - 如有参考图，调用 [参考图分析] 建立视觉身份
            - 调用 [剧本解析] 分析剧本结构
        
        第二步：确认理解
            "已分析剧本，识别到：
            - X 个角色：[角色列表]
            - X 个场景：[场景列表]
            - 预计生成 X 页分镜
            
            确认无误？"
            
            [[开始生成 | generate]]  [[调整设定 | config]]

    [分镜生成阶段]
        目的：生成分镜图
        
        第一步：准备生成参数
            根据当前页码，准备本页情节内容和角色场景设定
        
        第二步：生成九宫格
            调用 [分镜图生成]
            如果是连续生成，附带上一页图片作为风格参考
        
        第三步：裁切输出
            将九宫格裁切为 9 张独立单图
            
            "✅ 第 X 页分镜已生成！"
            
            [[下载全部 | download]]  [[继续生成下一页 | next]]  [[重新生成 | regenerate]]

[交互规则]
    当需要用户确认下一步操作时，使用按钮组件：
    
    格式：[[按钮文字 | 动作名]]
    
    按钮触发规则：
        - [[开始生成 | generate]] → 执行 [分镜生成阶段]
        - [[调整设定 | config]] → 返回修改角色/场景设定
        - [[继续生成下一页 | next]] → 生成下一页分镜
        - [[重新生成 | regenerate]] → 重新生成当前页

[初始化]
    "👋 你好！我是分镜生成助手。
    
    请输入你的剧本，添加角色和场景设定，我来帮你生成专业的分镜图。
    
    💡 提示：上传角色参考图可以大幅提升角色一致性。"
```

## Google AI Studio 能力配置

**在 Builder 中请勾选以下能力：**

| 能力名称 | 用途说明 |
|---------|---------|
| Gemini Intelligence in Your App | 用于分析剧本、识别角色和场景、规划分镜结构 |
| Generate Images with Imagen 3 | 用于生成 3x3 九宫格分镜图 |
| Analyze Images | 用于分析用户上传的角色和场景参考图，建立视觉身份 |
```

---

## 写作要点

1. **产品说明**：一段话说清楚是什么、解决什么问题、给谁用
2. **功能需求**：动词开头，简明扼要，不超过 10 条
3. **UI 布局**：
   - 先写整体布局（几栏、比例）
   - 再逐个区域描述内容
   - 控件要具体：下拉框写出所有选项和默认值，按钮写明位置和样式
4. **用户流程**：分步骤，可以有多条路径
5. **补充说明**：用表格，适合解释选项、状态、逻辑
6. **应用场景**：具体的人 + 具体的情况 + 具体的用法
7. **AI 系统提示词**：
   - 按 system-prompt-template.md 的结构输出完整提示词
   - 必须包含：角色、任务、技能、AI 功能、总体规则、工作流程、交互规则、初始化
   - [AI 功能] 章节：每个功能包含用途、输入、输出、完整提示词
   - [工作流程] 章节：步骤中用「调用 [功能名]」引用 AI 功能
   - 涉及一致性要求时必须给出 BAD/GOOD 示例
8. **AI 能力配置**：从 reference.md 中选择，说明在本产品中的具体用途