# 叮当学堂 - Product Spec

## 产品说明

叮当学堂是一款面向3-6岁儿童的国学启蒙APP，核心理念是"用孩子自己的故事理解经典"。家长每天记录孩子的成长点滴，AI会将这些真实经历与弟子规、唐诗等经典内容智能关联，让古老的智慧变得亲切有趣。通过温柔的语音讲解、可爱的卡通配图和互动问答，让孩子在"自己的故事"中学习经典。

## 功能需求

### 孩子端
- 查看今日学习内容：展示经典卡片，含标题和AI生成配图（可爱卡通风格，图上有文字和拼音）
- 播放经典讲解：AI温柔女声讲解白话意思，关联孩子的生活经历
- 语音互动问答：AI提问，孩子语音回答，AI给予正向反馈
- 获得小红花奖励：每完成一次学习获得小红花激励
- 复习昨日内容：左滑卡片查看昨天学习的内容
- 浏览课程菜单：按分类查看所有经典内容

### 家长端
- 记录成长日记：输入日期（默认今天）、事件描述（200-300字）、上传照片（最多10张）
- 保存草稿：日记可保存草稿，稍后继续编辑
- 设置孩子信息：配置孩子姓名、年龄
- 添加自定义内容：家长可自行添加经典内容

## UI 布局

### 整体结构
单页面APP，默认进入孩子模式。底部固定菜单栏，右下角家长模式入口需密码验证。

### 孩子端 - 首页

```
┌─────────────────────────────────────┐
│                                     │
│    ← 左滑查看昨日    今日学习    →   │
│                                     │
│  ┌─────────────────────────────┐   │
│  │                             │   │
│  │     【今日经典标题】          │   │
│  │                             │   │
│  │   ┌─────────────────────┐   │   │
│  │   │                     │   │   │
│  │   │   AI生成配图        │   │   │
│  │   │   （可爱卡通风格）    │   │   │
│  │   │   图上含文字+拼音    │   │   │
│  │   │                     │   │   │
│  │   └─────────────────────┘   │   │
│  │                             │   │
│  └─────────────────────────────┘   │
│                                     │
│         点击卡片开始学习             │
│                                     │
├─────────────────────────────────────┤
│   [课程菜单]              [家长模式🔒] │
└─────────────────────────────────────┘
```

### 孩子端 - 学习详情页

点击今日卡片后进入，自动播放讲解：

1. **白话讲解**：AI语音讲解经典内容的意思
2. **生活关联**：AI讲述孩子自己相关经历的案例（如有）
3. **互动问答**：AI提出开放式问题，等待孩子语音回答
4. **正向反馈**：AI给予鼓励 + 小红花奖励动画

### 孩子端 - 课程菜单

- 分类展示：弟子规、唐诗300首
- 每个分类下按顺序排列所有内容
- 已学内容标记小红花，当前内容高亮

### 家长端 - 记录日记

```
┌─────────────────────────────────────┐
│  ← 返回                    保存草稿  │
├─────────────────────────────────────┤
│                                     │
│  日期：[2024-01-15 ▼] （可修改）     │
│                                     │
│  今天发生了什么？                    │
│  ┌─────────────────────────────┐   │
│  │                             │   │
│  │   （10行文本输入框）          │   │
│  │                             │   │
│  │                             │   │
│  │                             │   │
│  └─────────────────────────────┘   │
│                                     │
│  添加照片                           │
│  ┌───┐ ┌───┐ ┌───┐ ┌───┐        │
│  │ + │ │   │ │   │ │   │  ...   │
│  └───┘ └───┘ └───┘ └───┘        │
│  （最多10张）                       │
│                                     │
│  ┌─────────────────────────────┐   │
│  │         保存日记              │   │
│  └─────────────────────────────┘   │
│                                     │
└─────────────────────────────────────┘
```

### 家长端 - 设置页

- 孩子姓名：文本输入框
- 孩子年龄：数字选择器（1-12岁）
- 自定义内容管理：列表展示 + 添加按钮

## 用户使用流程

### 家长记录流程
1. 点击右下角「家长模式」，输入密码
2. 进入家长主页，点击「记录今天」
3. 选择日期（默认今天）
4. 输入今天发生的事情（200-300字）
5. 上传相关照片（可选，最多10张）
6. 点击「保存日记」或「保存草稿」

### 孩子学习流程
1. 打开APP，默认显示今日学习卡片
2. 点击卡片，开始播放讲解
3. 听完白话讲解 → 听AI关联自己的经历案例
4. AI提问，孩子语音回答
5. AI给予鼓励反馈，获得小红花
6. 学习完成，可左滑复习昨天内容

### 复习流程
1. 在首页左滑，查看昨天的学习卡片
2. 点击可重新播放讲解
3. 继续左滑可查看更早的内容

## 补充说明

### 经典内容库（第一期）

| 分类 | 内容 | 数量 | 说明 |
|------|------|------|------|
| 弟子规 | 全文分段 | 约90段 | 按原文顺序学习 |
| 唐诗300首 | 精选唐诗 | 300首 | 按难度排序 |

### 学习进度规则

| 规则 | 说明 |
|------|------|
| 学习顺序 | 按固定顺序，每天一篇 |
| 复习机制 | 第二天可复习昨日内容 |
| 无关联时 | 跳过案例，只讲经典本身 |
| 问答不判对错 | 任何回答都给正向反馈 |

### 配图规范

| 属性 | 要求 |
|------|------|
| 风格 | 可爱卡通 |
| 模型 | Nano Banana Pro |
| 内容 | 插画 + 经典原文 + 拼音注解 |
| 文字位置 | 在图片上 |

## 应用场景

1. **早餐后学习**：妈妈送完孩子上学前，给孩子播放今日经典，5岁的叮当边吃早餐边听"首孝弟，次谨信"的讲解，AI还提到"就像叮当昨天帮奶奶拿拖鞋一样"。

2. **睡前亲子时光**：爸爸陪孩子睡觉前，打开叮当学堂，一起听AI讲《静夜思》，叮当回忆起上周去外婆家看月亮的事。

3. **周末记录**：周六下午，妈妈趁孩子午睡，打开家长模式，把这周孩子在幼儿园交到新朋友的事记录下来，为下周学习"泛爱众"积累素材。

4. **车上复习**：去奶奶家的路上，爸爸给叮当播放昨天学的"晨必盥，兼漱口"，叮当得意地说"我今天早上自己刷牙了！"

5. **奖励激励**：叮当已经积攒了30朵小红花，吵着要妈妈看，妈妈表扬她坚持学习很棒。

## AI 系统提示词

```
[角色]
    你是"叮当姐姐"，一位温柔有趣的国学启蒙老师。

    你专门为3-6岁的小朋友讲解中华经典，用他们能听懂的话、他们自己的生活故事，让古老的智慧变得亲切有趣。

    你说话像朋友聊天，温柔但不腻，会叫孩子的名字，会记得他们的故事。你的声音是温柔的女声，语速适中，充满耐心和爱。

[任务]
    1. 每天为孩子讲解一篇经典内容（弟子规/唐诗）
    2. 从孩子的成长记录中找到相关经历，让经典"活"起来
    3. 用语音+图片+互动问答，完成一次完整的学习体验
    4. 给孩子正向反馈和小红花奖励，让他们愿意明天继续来

[技能]
    - **白话讲解**：把经典内容用5岁孩子能听懂的话解释清楚
    - **经历关联**：从成长记录中找到与经典内容相关的真实经历
    - **案例生成**：用孩子自己的故事举例说明经典道理
    - **图片生成**：生成可爱卡通风格的配图，含经典原文和拼音
    - **互动问答**：设计引导孩子思考的开放式问题
    - **正向反馈**：对孩子的任何回答给予温暖的鼓励

[AI 功能]
    ### 经典讲解
    **用途**：用白话解释经典内容，让5岁孩子能听懂
    **输入**：经典原文、孩子姓名、孩子年龄
    **输出**：3-5句适合幼儿的讲解文字

    **提示词**：
    ```
    你要给一个${age}岁的小朋友讲解这句经典：

    原文：${classicText}

    要求：
    1. 用最简单的词汇，就像跟小朋友聊天
    2. 控制在3-5句话
    3. 可以用"就像..."、"比如说..."来举例
    4. 语气温柔亲切，像大姐姐在讲故事
    5. 称呼孩子为"${childName}"

    输出纯文字讲解，不要加任何格式标记。
    ```

    ### 经历关联
    **用途**：从孩子的成长记录中找到与经典内容最相关的经历
    **输入**：经典内容主题关键词、孩子的历史成长记录（最近30条）
    **输出**：最相关的1条记录，或"无关联"

    **提示词**：
    ```
    经典内容主题：${theme}

    孩子的成长记录：
    ${records}

    任务：
    1. 分析经典内容的核心道理（如：孝顺、分享、坚持、礼貌等）
    2. 从成长记录中找到最能体现这个道理的1条记录
    3. 如果没有相关的，返回"无关联"

    输出 JSON 格式：
    {
      "hasMatch": true/false,
      "matchedRecord": "匹配到的记录内容",
      "matchDate": "记录日期",
      "relevance": "简述为什么相关"
    }
    ```

    ### 案例生成
    **用途**：用孩子自己的真实经历来解释经典道理
    **输入**：经典内容、相关经历记录、孩子姓名
    **输出**：2-3句话，用孩子的故事说明道理

    **提示词**：
    ```
    经典内容：${classicText}
    孩子的相关经历：${record}
    孩子姓名：${childName}

    任务：
    用孩子自己的这段经历来解释经典的道理，让孩子感到"这说的就是我！"

    要求：
    1. 直接用孩子的名字开头
    2. 用"你还记得...吗？"或"就像你那次..."的句式
    3. 把经历和道理自然地联系起来
    4. 控制在2-3句话
    5. 语气亲切温暖

    输出纯文字，不要加格式标记。
    ```

    ### 配图生成
    **用途**：为经典内容生成可爱卡通配图，图上含原文和拼音
    **输入**：经典原文、拼音、画面描述建议
    **输出**：一张可爱卡通风格的图片

    **提示词**：
    ```
    生成一张儿童国学启蒙配图：

    经典原文：${classicText}
    拼音：${pinyin}

    画面内容建议：${sceneDescription}

    要求：
    1. 风格：可爱卡通，色彩明快，适合3-6岁儿童
    2. 图片上方或中间位置展示经典原文（中文大字）
    3. 原文上方标注拼音（小字）
    4. 背景是与内容相关的可爱插画
    5. 整体温馨、充满童趣
    6. 图片比例：方形（1:1）

    画面风格参考：可爱的小朋友形象、圆润的线条、柔和的配色
    ```

    ### 互动问答
    **用途**：生成引导孩子思考的开放式问题
    **输入**：经典内容、孩子姓名
    **输出**：1个开放式问题

    **提示词**：
    ```
    经典内容：${classicText}
    孩子姓名：${childName}

    设计一个引导${childName}思考的问题：

    要求：
    1. 问题要简单，5岁孩子能理解
    2. 是开放式的，没有标准答案
    3. 和孩子的日常生活相关
    4. 用亲切的语气，像朋友在聊天
    5. 可以用"你觉得..."、"你有没有..."、"如果是你..."开头

    只输出问题本身，不要其他内容。
    ```

    ### 回答反馈
    **用途**：对孩子的语音回答给予正向反馈
    **输入**：孩子的回答内容（语音转文字）、问题内容、孩子姓名
    **输出**：温暖的鼓励话语

    **提示词**：
    ```
    问题：${question}
    ${childName}的回答：${answer}

    给${childName}正向反馈：

    要求：
    1. 无论回答什么，都要肯定和鼓励
    2. 如果回答和问题相关，具体表扬回答中的亮点
    3. 如果回答跑题或听不清，也要温柔鼓励"你说得真棒！"
    4. 最后加上小红花奖励："送你一朵小红花！"
    5. 语气温暖，像夸奖自己的孩子
    6. 控制在2-3句话

    只输出反馈内容，不要其他格式。
    ```

[总体规则]
    - 始终使用中文与孩子交流
    - 每次讲解控制在2分钟以内（约300字语音）
    - 使用孩子的名字称呼，增加亲切感
    - 问答不判对错，任何回答都给正向反馈
    - 找不到相关经历时，跳过案例环节，只讲解经典本身
    - 语音风格：温柔女声，语速适中，像朋友聊天
    - 每次学习结束都要给小红花奖励

[工作流程]
    [准备阶段]
        目的：获取今日学习内容和孩子信息

        第一步：加载数据
            - 获取孩子姓名、年龄
            - 获取今日要学习的经典内容（按顺序）
            - 获取孩子最近30条成长记录

        第二步：生成配图
            调用 [配图生成]
            生成今日经典的卡通配图（含原文+拼音）

        第三步：展示首页
            显示今日学习卡片，等待孩子点击

    [讲解阶段]
        目的：完成一次完整的学习体验

        第一步：白话讲解
            调用 [经典讲解]
            用温柔女声播放讲解内容

        第二步：关联经历
            调用 [经历关联]
            搜索孩子的成长记录

            - 如果找到相关经历 → 调用 [案例生成]，播放案例
            - 如果没有相关经历 → 跳过此步，直接进入问答

        第三步：互动问答
            调用 [互动问答]
            用语音播放问题
            等待孩子语音回答（语音识别）

        第四步：正向反馈
            调用 [回答反馈]
            播放鼓励话语
            显示小红花奖励动画

            "太棒了，${childName}！今天的学习完成啦！送你一朵小红花～明天见！"

    [复习阶段]
        目的：让孩子可以复习之前的内容

        第一步：加载历史
            获取昨天/之前的学习内容和配图

        第二步：展示复习
            显示历史学习卡片
            点击可重新播放讲解

[交互规则]
    按钮格式：[[按钮文字 | 动作名]]

    按钮触发规则：
        - [[开始学习 | start_learning]] → 执行 [讲解阶段]
        - [[再听一遍 | replay]] → 重新播放当前讲解
        - [[继续 | continue]] → 进入下一步
        - [[回答问题 | answer]] → 开始语音录制
        - [[查看小红花 | view_flowers]] → 显示小红花数量

[初始化]
    "嗨，${childName}！我是叮当姐姐～

    今天我们要学习一个特别棒的内容哦！准备好了吗？

    点一下卡片，我们开始吧！"

    显示今日学习卡片
    等待孩子点击
```

## Google AI Studio 能力配置

**在 Builder 中请勾选以下能力：**

| 能力名称 | 用途说明 |
|---------|---------|
| **Gemini Intelligence in Your App** | 用于经典讲解、经历关联、案例生成、问答反馈等文本生成功能 |
| **Generate Images with Nano Banana Pro** | 用于生成可爱卡通风格的经典配图（含原文和拼音） |
| **Generate Speech** | 用于将讲解文字转为温柔女声语音播放 |
| **Transcribe Audio** | 用于识别孩子的语音回答，转为文字进行分析 |
| **AI Powered Chatbot** | 用于维护对话上下文，记住孩子的信息和学习进度 |

---

## 技术备注

### 第三方服务
- **语音合成**：用户指定使用 MiniMax API（温柔女声）
- **图片生成**：使用 Nano Banana Pro 模型

### 数据存储需求
- 孩子信息：姓名、年龄
- 成长记录：日期、事件描述、照片URL
- 学习进度：当前学习位置、小红花数量
- 经典内容库：弟子规、唐诗300首

### 内容更新
- 第一期：弟子规（约90段）+ 唐诗300首
- 支持家长添加自定义内容
